(function($){$.fn.imglazyload=function(options){var o=$.extend({attr:'lazy-src',container:window,event:'scroll',fadeIn:false,threshold:0,vertical:true},options),event=o.event,vertical=o.vertical,container=$(o.container),threshold=o.threshold,elems=$.makeArray($(this)),dataName='imglazyload_offset',OFFSET=vertical?'top':'left',SCROLL=vertical?'scrollTop':'scrollLeft',winSize=vertical?container.height():container.width(),scrollCoord=container[SCROLL](),docSize=winSize+scrollCoord;var trigger={init:function(coord){return coord>=scrollCoord&&coord<=(docSize+threshold);},scroll:function(coord){var scrollCoord=container[SCROLL]();return coord>=scrollCoord&&coord<=(winSize+scrollCoord+threshold);},resize:function(coord){var scrollCoord=container[SCROLL](),winSize=vertical?container.height():container.width();return coord>=scrollCoord&&coord<=(winSize+scrollCoord+threshold);}};var loader=function(triggerElem,event){var i=0,isCustom=false,isTrigger,coord,elem,$elem,lazySrc;if(event){if(event!=='scroll'&&event!=='resize'){isCustom=true;}}else{event='init';}for(;i<elems.length;i++){isTrigger=false;elem=elems[i];$elem=$(elem);lazySrc=$elem.attr(o.attr);if(!lazySrc||elem.src===lazySrc){continue;}coord=$elem.data(dataName);if(coord===undefined){coord=$elem.offset()[OFFSET];$elem.data(dataName,coord);}isTrigger=isCustom||trigger[event](coord);if(isTrigger){elem.src=lazySrc;if(o.fadeIn){$elem.hide().fadeIn();}$elem.removeData(dataName);elems.splice(i--,1);}}if(!elems.length){if(triggerElem){triggerElem.unbind(event,fire);}else{container.unbind(o.event,fire);}$(window).unbind('resize',fire);elems=null;}};var fire=function(e){loader($(this),e.type);};container=event==='scroll'?container:$(this);container.bind(event,fire);$(window).bind('resize',fire);$(window).bind('load',fire);loader();return this;};})(jQuery);